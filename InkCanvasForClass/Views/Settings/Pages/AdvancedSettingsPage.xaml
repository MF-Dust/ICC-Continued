<UserControl x:Class="Ink_Canvas.Views.Settings.Pages.AdvancedSettingsPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
             xmlns:local="clr-namespace:Ink_Canvas.Views.Settings.Pages"
             xmlns:vm="clr-namespace:Ink_Canvas.ViewModels.Settings"
             xmlns:wc="clr-namespace:System.Windows.Controls;assembly=PresentationFramework"
             mc:Ignorable="d"
             d:DesignHeight="1500" d:DesignWidth="800"
             Background="Transparent"
             d:DataContext="{d:DesignInstance vm:AdvancedSettingsViewModel, IsDesignTimeCreatable=True}">

    <UserControl.Resources>
        <wc:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    </UserControl.Resources>

    <ui:DynamicScrollViewer VerticalScrollBarVisibility="Auto" PanningMode="VerticalOnly">
        <StackPanel Margin="0,0,12,24">
            <!-- Header -->
            <ui:TextBlock Text="高级" FontTypography="Title" Margin="0,0,0,12" />
            <ui:TextBlock Text="高级与实验性功能配置" 
                          FontTypography="Body" Foreground="{DynamicResource TextFillColorSecondaryBrush}" Margin="0,0,0,24"/>

            <!-- Gesture Eraser Warning -->
            <ui:InfoBar Severity="Error" IsOpen="{Binding IsSpecialScreen, Mode=OneWay}"
                        Title="设置项已被禁用"
                        Message="手势橡皮相关功能已经被禁用！该部分不可用！"
                        Margin="0,0,0,24" />
            
            <ui:TextBlock Text="可在手指触摸画板时显示圆形橡皮或手掌触摸画板时显示的橡皮比手掌大很多时调整"
                          FontTypography="Caption" Foreground="{DynamicResource TextFillColorSecondaryBrush}" Margin="0,0,0,12"/>

            <!-- Touch & Eraser Settings -->
            <ui:CardExpander Margin="0,0,0,12" IsExpanded="True">
                <ui:CardExpander.Icon>
                    <ui:SymbolIcon Symbol="HandRight24"/>
                </ui:CardExpander.Icon>
                <ui:CardExpander.Header>
                    <ui:TextBlock Text="触摸与橡皮擦" FontTypography="Body"/>
                </ui:CardExpander.Header>
                <StackPanel>
                    <!-- Special Screen Mode -->
                    <ui:CardControl Margin="0,0,0,4">
                         <ui:CardControl.Icon>
                            <ui:SymbolIcon Symbol="Desktop24"/>
                        </ui:CardControl.Icon>
                        <ui:CardControl.Header>
                            <ui:TextBlock Text="特殊屏幕模式" FontTypography="Body"/>
                        </ui:CardControl.Header>
                        <ui:ToggleSwitch IsChecked="{Binding Advanced.IsSpecialScreen, Mode=TwoWay}"/>
                    </ui:CardControl>

                    <!-- Touch Multiplier -->
                    <ui:CardControl Margin="0,0,0,4">
                        <ui:CardControl.Header>
                            <ui:TextBlock Text="触摸倍数" FontTypography="Body"/>
                        </ui:CardControl.Header>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" MinWidth="200">
                             <Slider Minimum="0.1" Maximum="5.0" Value="{Binding Advanced.TouchMultiplier, Mode=TwoWay}" 
                                     Width="150" VerticalAlignment="Center" Margin="0,0,12,0"/>
                             <TextBlock Text="{Binding Advanced.TouchMultiplier, StringFormat=N2}" VerticalAlignment="Center" Width="30"/>
                        </StackPanel>
                    </ui:CardControl>
                    
                    <ui:TextBlock Text="BoundsWidth 参数作为接触面积区分界限，用来区分橡皮和书写模式。笔尖模式参数值应较小。"
                              FontTypography="Caption" Foreground="{DynamicResource TextFillColorSecondaryBrush}" Margin="16,8,16,4"/>
                     <ui:TextBlock Text="ThresholdValue 参数用来区分 墨迹擦、面积擦。触控面积达到 BoundsWidth 的界限后，触控面积小于等于 BoundsWidth * ThresholdValue 则为墨迹擦，大于则为面积擦。默认均为 2.5"
                              FontTypography="Caption" Foreground="{DynamicResource TextFillColorSecondaryBrush}" Margin="16,0,16,12"/>

                    <!-- Nib Mode ThresholdValue -->
                    <ui:CardControl Margin="0,0,0,4">
                        <ui:CardControl.Header>
                            <ui:TextBlock Text="笔尖模式 ThresholdValue" FontTypography="Body"/>
                        </ui:CardControl.Header>
                         <StackPanel Orientation="Horizontal" VerticalAlignment="Center" MinWidth="200">
                             <Slider Minimum="0.1" Maximum="10.0" Value="{Binding Advanced.NibModeBoundsWidthThresholdValue, Mode=TwoWay}" 
                                     Width="150" VerticalAlignment="Center" Margin="0,0,12,0"/>
                             <TextBlock Text="{Binding Advanced.NibModeBoundsWidthThresholdValue, StringFormat=N1}" VerticalAlignment="Center" Width="30"/>
                        </StackPanel>
                    </ui:CardControl>

                    <!-- Finger Mode ThresholdValue -->
                    <ui:CardControl Margin="0,0,0,4">
                        <ui:CardControl.Header>
                            <ui:TextBlock Text="手指模式 ThresholdValue" FontTypography="Body"/>
                        </ui:CardControl.Header>
                         <StackPanel Orientation="Horizontal" VerticalAlignment="Center" MinWidth="200">
                             <Slider Minimum="0.1" Maximum="10.0" Value="{Binding Advanced.FingerModeBoundsWidthThresholdValue, Mode=TwoWay}" 
                                     Width="150" VerticalAlignment="Center" Margin="0,0,12,0"/>
                             <TextBlock Text="{Binding Advanced.FingerModeBoundsWidthThresholdValue, StringFormat=N1}" VerticalAlignment="Center" Width="30"/>
                        </StackPanel>
                    </ui:CardControl>
                    
                     <ui:TextBlock Text="EraserSize 参数用来调节触控的面积擦大小。默认值均为 0.8"
                              FontTypography="Caption" Foreground="{DynamicResource TextFillColorSecondaryBrush}" Margin="16,8,16,12"/>

                    <!-- Nib Mode EraserSize -->
                    <ui:CardControl Margin="0,0,0,4">
                        <ui:CardControl.Header>
                            <ui:TextBlock Text="笔尖模式 EraserSize" FontTypography="Body"/>
                        </ui:CardControl.Header>
                         <StackPanel Orientation="Horizontal" VerticalAlignment="Center" MinWidth="200">
                             <Slider Minimum="0.1" Maximum="5.0" Value="{Binding Advanced.NibModeBoundsWidthEraserSize, Mode=TwoWay}" 
                                     Width="150" VerticalAlignment="Center" Margin="0,0,12,0"/>
                             <TextBlock Text="{Binding Advanced.NibModeBoundsWidthEraserSize, StringFormat=N1}" VerticalAlignment="Center" Width="30"/>
                        </StackPanel>
                    </ui:CardControl>

                    <!-- Finger Mode EraserSize -->
                    <ui:CardControl Margin="0,0,0,4">
                        <ui:CardControl.Header>
                            <ui:TextBlock Text="手指模式 EraserSize" FontTypography="Body"/>
                        </ui:CardControl.Header>
                         <StackPanel Orientation="Horizontal" VerticalAlignment="Center" MinWidth="200">
                             <Slider Minimum="0.1" Maximum="5.0" Value="{Binding Advanced.FingerModeBoundsWidthEraserSize, Mode=TwoWay}" 
                                     Width="150" VerticalAlignment="Center" Margin="0,0,12,0"/>
                             <TextBlock Text="{Binding Advanced.FingerModeBoundsWidthEraserSize, StringFormat=N1}" VerticalAlignment="Center" Width="30"/>
                        </StackPanel>
                    </ui:CardControl>
                    
                     <ui:TextBlock Text="四边红外触控屏启用 四边红外模式 有利于触控面积的确定"
                              FontTypography="Caption" Foreground="{DynamicResource TextFillColorSecondaryBrush}" Margin="16,8,16,12"/>

                    <!-- Quad IR Mode -->
                    <ui:CardControl Margin="0,0,0,0">
                         <ui:CardControl.Icon>
                            <ui:SymbolIcon Symbol="ScanDash24"/>
                        </ui:CardControl.Icon>
                        <ui:CardControl.Header>
                            <ui:TextBlock Text="四边红外模式" FontTypography="Body"/>
                        </ui:CardControl.Header>
                        <ui:ToggleSwitch IsChecked="{Binding Advanced.IsQuadIR, Mode=TwoWay}"/>
                    </ui:CardControl>

                </StackPanel>
            </ui:CardExpander>

            <!-- Advanced Features -->
            <ui:CardExpander Margin="0,0,0,24" IsExpanded="True">
                <ui:CardExpander.Icon>
                    <ui:SymbolIcon Symbol="Wrench24"/>
                </ui:CardExpander.Icon>
                <ui:CardExpander.Header>
                    <ui:TextBlock Text="高级功能" FontTypography="Body"/>
                </ui:CardExpander.Header>
                <StackPanel>
                    <!-- Log Enabled -->
                    <ui:CardControl Margin="0,0,0,4">
                        <ui:CardControl.Header>
                            <StackPanel>
                                <ui:TextBlock Text="记录日志" FontTypography="Body"/>
                                <ui:TextBlock Text="日志文件超过 512 KB 时会自动删除" FontTypography="Caption" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                            </StackPanel>
                        </ui:CardControl.Header>
                        <ui:ToggleSwitch IsChecked="{Binding Advanced.IsLogEnabled, Mode=TwoWay}"/>
                    </ui:CardControl>

                    <!-- FullScreenHelper -->
                    <ui:CardControl Margin="0,0,0,4">
                         <ui:CardControl.Icon>
                            <ui:SymbolIcon Symbol="FullScreenMaximize24"/>
                        </ui:CardControl.Icon>
                        <ui:CardControl.Header>
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                    <ui:TextBlock Text="启用 FullScreenHelper" FontTypography="Body"/>
                                    <Border Background="{DynamicResource SystemAccentColorPrimaryBrush}" CornerRadius="4" Margin="8,0,0,0" Padding="6,2">
                                        <TextBlock Text="实验性" FontSize="10" Foreground="White"/>
                                    </Border>
                                </StackPanel>
                                <ui:TextBlock Text="减少任务栏弹出问题，支持多显示器自动全屏" FontTypography="Caption" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                            </StackPanel>
                        </ui:CardControl.Header>
                        <ui:ToggleSwitch IsChecked="{Binding Advanced.IsEnableFullScreenHelper, Mode=TwoWay}"/>
                    </ui:CardControl>

                    <!-- Disable Edge Gestures -->
                    <ui:CardControl Margin="0,0,0,4">
                         <ui:CardControl.Icon>
                            <ui:SymbolIcon Symbol="HandRight24"/>
                        </ui:CardControl.Icon>
                        <ui:CardControl.Header>
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                    <ui:TextBlock Text="书写时禁用 Win10/11 边缘手势" FontTypography="Body"/>
                                    <Border Background="{DynamicResource SystemAccentColorPrimaryBrush}" CornerRadius="4" Margin="8,0,0,0" Padding="6,2">
                                        <TextBlock Text="新功能" FontSize="10" Foreground="White"/>
                                    </Border>
                                </StackPanel>
                                <ui:TextBlock Text="仅在屏幕批注、PPT批注、白板模式时禁用边缘手势" FontTypography="Caption" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                            </StackPanel>
                        </ui:CardControl.Header>
                        <ui:ToggleSwitch IsChecked="{Binding Advanced.IsEnableEdgeGestureUtil, Mode=TwoWay}"/>
                    </ui:CardControl>

                    <!-- Prevent Window Close -->
                     <ui:CardControl Margin="0,0,0,4">
                         <ui:CardControl.Icon>
                            <ui:SymbolIcon Symbol="DismissSquare24"/>
                        </ui:CardControl.Icon>
                        <ui:CardControl.Header>
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                    <ui:TextBlock Text="阻止意外关闭窗口" FontTypography="Body"/>
                                    <Border Background="{DynamicResource SystemAccentColorPrimaryBrush}" CornerRadius="4" Margin="8,0,0,0" Padding="6,2">
                                        <TextBlock Text="新功能" FontSize="10" Foreground="White"/>
                                    </Border>
                                </StackPanel>
                            </StackPanel>
                        </ui:CardControl.Header>
                        <ui:ToggleSwitch IsChecked="{Binding Advanced.IsDisableCloseWindow, Mode=TwoWay}"/>
                    </ui:CardControl>

                     <!-- Force Topmost -->
                     <ui:CardControl Margin="0,0,0,4">
                         <ui:CardControl.Icon>
                            <ui:SymbolIcon Symbol="ArrowUp24"/>
                        </ui:CardControl.Icon>
                        <ui:CardControl.Header>
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                    <ui:TextBlock Text="强制置顶窗口" FontTypography="Body"/>
                                    <Border Background="{DynamicResource SystemAccentColorPrimaryBrush}" CornerRadius="4" Margin="8,0,0,0" Padding="6,2">
                                        <TextBlock Text="新功能" FontSize="10" Foreground="White"/>
                                    </Border>
                                </StackPanel>
                                <ui:TextBlock Text="在 Windows 7 下解决窗口置顶问题" FontTypography="Caption" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                            </StackPanel>
                        </ui:CardControl.Header>
                        <ui:ToggleSwitch IsChecked="{Binding Advanced.EnableForceTopMost, Mode=TwoWay}"/>
                    </ui:CardControl>

                    <!-- Force Full Screen -->
                     <ui:CardControl Margin="0,0,0,4">
                         <ui:CardControl.Icon>
                            <ui:SymbolIcon Symbol="ArrowExpand24"/>
                        </ui:CardControl.Icon>
                        <ui:CardControl.Header>
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                    <ui:TextBlock Text="让 ICC 窗口始终可见且全屏显示" FontTypography="Body"/>
                                    <Border Background="{DynamicResource SystemAccentColorPrimaryBrush}" CornerRadius="4" Margin="8,0,0,0" Padding="6,2">
                                        <TextBlock Text="新功能" FontSize="10" Foreground="White"/>
                                    </Border>
                                </StackPanel>
                                <ui:TextBlock Text="自动检测窗口大小变化并恢复，被遮挡时自动恢复置顶" FontTypography="Caption" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                            </StackPanel>
                        </ui:CardControl.Header>
                        <ui:ToggleSwitch IsChecked="{Binding Advanced.IsEnableForceFullScreen, Mode=TwoWay}"/>
                    </ui:CardControl>

                    <!-- Ensure Toolbar On Screen -->
                     <ui:CardControl Margin="0,0,0,0">
                         <ui:CardControl.Icon>
                            <ui:SymbolIcon Symbol="ResizeLarge24"/>
                        </ui:CardControl.Icon>
                        <ui:CardControl.Header>
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                    <ui:TextBlock Text="实时确保浮动工具栏显示在屏幕内" FontTypography="Body"/>
                                    <Border Background="{DynamicResource SystemAccentColorPrimaryBrush}" CornerRadius="4" Margin="8,0,0,0" Padding="6,2">
                                        <TextBlock Text="新功能" FontSize="10" Foreground="White"/>
                                    </Border>
                                </StackPanel>
                                <ui:TextBlock Text="实时监听分辨率/DPI变更，确保工具栏可见" FontTypography="Caption" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                            </StackPanel>
                        </ui:CardControl.Header>
                        <ui:ToggleSwitch IsChecked="{Binding Advanced.IsEnableResolutionChangeDetection, Mode=TwoWay}"/>
                    </ui:CardControl>

                </StackPanel>
            </ui:CardExpander>

        </StackPanel>
    </ui:DynamicScrollViewer>
</UserControl>
